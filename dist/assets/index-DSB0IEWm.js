(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const Pe=()=>{const e=document.querySelector("#app"),t=document.createElement("footer"),n=document.createElement("p");n.innerHTML='© 2025 Creado por Clara Manzano Corona | Código abierto en <a href="https://github.com/ClaraDevelope" target="_blank"> GitHub</a> | Eclipso',t.appendChild(n),e.append(t)};var _e=/([:*])(\w+)/g,He="([^/]+)",xe=/\*/g,$e="?(?:.*)",Re=/\/\?/g,Oe="/?([^/]+|)",Me="(?:/^|^)",Ne="";function ue(e){return e===void 0&&(e="/"),Z()?location.pathname+location.search+location.hash:e}function T(e){return e.replace(/\/+$/,"").replace(/^\/+/,"")}function z(e){return typeof e=="string"}function Fe(e){return typeof e=="function"}function j(e){return e&&e.indexOf("#")>=0&&e.split("#").pop()||""}function Be(e,t){return t.length===0||!e?null:e.slice(1,e.length).reduce(function(n,a,o){return n===null&&(n={}),n[t[o]]=decodeURIComponent(a),n},null)}function U(e){var t=T(e).split(/\?(.*)?$/);return[T(t[0]),t.slice(1).join("")]}function J(e){for(var t={},n=e.split("&"),a=0;a<n.length;a++){var o=n[a].split("=");if(o[0]!==""){var r=decodeURIComponent(o[0]);t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(decodeURIComponent(o[1]||""))):t[r]=decodeURIComponent(o[1]||"")}}return t}function pe(e,t){var n=U(T(e.currentLocationPath)),a=n[0],o=n[1],r=o===""?null:J(o),i=[],s;if(z(t.path)){if(s=Me+T(t.path).replace(_e,function(p,d,f){return i.push(f),He}).replace(xe,$e).replace(Re,Oe)+"$",T(t.path)===""&&T(a)==="")return{url:a,queryString:o,hashString:j(e.to),route:t,data:null,params:r}}else s=t.path;var u=new RegExp(s,Ne),l=a.match(u);if(l){var m=z(t.path)?Be(l,i):l.groups?l.groups:l.slice(1);return{url:T(a.replace(new RegExp("^"+e.instance.root),"")),queryString:o,hashString:j(e.to),route:t,data:m,params:r}}return!1}function me(){return!!(typeof window<"u"&&window.history&&window.history.pushState)}function M(e,t){return typeof e[t]>"u"||e[t]===!0}function De(e){if(!e)return{};var t=e.split(","),n={},a;return t.forEach(function(o){var r=o.split(":").map(function(i){return i.replace(/(^ +| +$)/g,"")});switch(r[0]){case"historyAPIMethod":n.historyAPIMethod=r[1];break;case"resolveOptionsStrategy":a||(a={}),a.strategy=r[1];break;case"resolveOptionsHash":a||(a={}),a.hash=r[1]==="true";break;case"updateBrowserURL":case"callHandler":case"updateState":case"force":n[r[0]]=r[1]==="true";break}}),a&&(n.resolveOptions=a),n}function Z(){return typeof window<"u"}function Ge(e,t){return e===void 0&&(e=[]),t===void 0&&(t={}),e.filter(function(n){return n}).forEach(function(n){["before","after","already","leave"].forEach(function(a){n[a]&&(t[a]||(t[a]=[]),t[a].push(n[a]))})}),t}function H(e,t,n){var a=t||{},o=0;(function r(){if(!e[o]){n&&n(a);return}Array.isArray(e[o])?(e.splice.apply(e,[o,1].concat(e[o][0](a)?e[o][1]:e[o][2])),r()):e[o](a,function(i){typeof i>"u"||i===!0?(o+=1,r()):n&&n(a)})})()}H.if=function(e,t,n){return Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]),[e,t,n]};function re(e,t){typeof e.currentLocationPath>"u"&&(e.currentLocationPath=e.to=ue(e.instance.root)),e.currentLocationPath=e.instance._checkForAHash(e.currentLocationPath),t()}function X(e,t){for(var n=0;n<e.instance.routes.length;n++){var a=e.instance.routes[n],o=pe(e,a);if(o&&(e.matches||(e.matches=[]),e.matches.push(o),e.resolveOptions.strategy==="ONE")){t();return}}t()}function ze(e,t){e.navigateOptions&&(typeof e.navigateOptions.shouldResolve<"u"&&console.warn('"shouldResolve" is deprecated. Please check the documentation.'),typeof e.navigateOptions.silent<"u"&&console.warn('"silent" is deprecated. Please check the documentation.')),t()}function je(e,t){e.navigateOptions.force===!0?(e.instance._setCurrent([e.instance._pathToMatchObject(e.to)]),t(!1)):t()}var ie=Z(),Ue=me();function Ve(e,t){if(M(e.navigateOptions,"updateBrowserURL")){var n=("/"+e.to).replace(/\/\//g,"/"),a=ie&&e.resolveOptions&&e.resolveOptions.hash===!0;Ue?(history[e.navigateOptions.historyAPIMethod||"pushState"](e.navigateOptions.stateObj||{},e.navigateOptions.title||"",a?"#"+n:n),location&&location.hash&&(e.instance.__freezeListening=!0,setTimeout(function(){if(!a){var o=location.hash;location.hash="",location.hash=o}e.instance.__freezeListening=!1},1))):ie&&(window.location.href=e.to)}t()}function fe(e,t){var n=e.instance;if(!n.lastResolved()){t();return}H(n.lastResolved().map(function(a){return function(o,r){if(!a.route.hooks||!a.route.hooks.leave){r();return}var i=!1,s=e.instance.matchLocation(a.route.path,e.currentLocationPath,!1);if(a.route.path!=="*")i=!s;else{var u=e.matches?e.matches.find(function(l){return a.route.path===l.route.path}):!1;i=!u}if(M(e.navigateOptions,"callHooks")&&i){H(a.route.hooks.leave.map(function(l){return function(m,p){return l(function(d){d===!1?e.instance.__markAsClean(e):p()},e.matches&&e.matches.length>0?e.matches.length===1?e.matches[0]:e.matches:void 0)}}).concat([function(){return r()}]));return}else r()}}),{},function(){return t()})}function We(e,t){e.match.route.hooks&&e.match.route.hooks.before&&M(e.navigateOptions,"callHooks")?H(e.match.route.hooks.before.map(function(n){return function(o,r){return n(function(i){i===!1?e.instance.__markAsClean(e):r()},e.match)}}).concat([function(){return t()}])):t()}function Xe(e,t){M(e.navigateOptions,"callHandler")&&e.match.route.handler(e.match),e.instance.updatePageLinks(),t()}function Ke(e,t){e.match.route.hooks&&e.match.route.hooks.after&&M(e.navigateOptions,"callHooks")&&e.match.route.hooks.after.forEach(function(n){return n(e.match)}),t()}function Qe(e,t){var n=e.instance.lastResolved();if(n&&n[0]&&n[0].route===e.match.route&&n[0].url===e.match.url&&n[0].queryString===e.match.queryString){n.forEach(function(a){a.route.hooks&&a.route.hooks.already&&M(e.navigateOptions,"callHooks")&&a.route.hooks.already.forEach(function(o){return o(e.match)})}),t(!1);return}t()}function Ye(e,t){var n=e.instance._notFoundRoute;if(n){e.notFoundHandled=!0;var a=U(e.currentLocationPath),o=a[0],r=a[1],i=j(e.to);n.path=T(o);var s={url:n.path,queryString:r,hashString:i,data:null,route:n,params:r!==""?J(r):null};e.matches=[s],e.match=s}t()}function Je(e,t){(!e.resolveOptions||e.resolveOptions.noMatchWarning===!1||typeof e.resolveOptions.noMatchWarning>"u")&&console.warn('Navigo: "'+e.currentLocationPath+`" didn't match any of the registered routes.`),t()}function Ze(e,t){e.instance._setCurrent(null),t()}function he(e,t){M(e.navigateOptions,"updateState")&&e.instance._setCurrent(e.matches),t()}var ve=[Qe,We,Xe,Ke],se=[fe,Ye,H.if(function(e){var t=e.notFoundHandled;return t},ve.concat([he]),[Je,Ze])];function Q(){return Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Q.apply(this,arguments)}function ce(e,t){var n=0;function a(){if(n===e.matches.length){he(e,t);return}H(ve,Q({},e,{match:e.matches[n]}),function(){n+=1,a()})}fe(e,a)}function K(e){e.instance.__markAsClean(e)}function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Y.apply(this,arguments)}var le="[data-navigo]";function et(e,t){var n=t||{strategy:"ONE",hash:!1,noMatchWarning:!1,linksSelector:le},a=this,o="/",r=null,i=[],s=!1,u,l=me(),m=Z();e?o=T(e):console.warn('Navigo requires a root path in its constructor. If not provided will use "/" as default.');function p(c){return c.indexOf("#")>=0&&(n.hash===!0?c=c.split("#")[1]||"/":c=c.split("#")[0]),c}function d(c){return T(o+"/"+T(c))}function f(c,h,E,w){return c=z(c)?d(c):c,{name:w||T(String(c)),path:c,handler:h,hooks:Ge(E)}}function v(c,h,E){var w=this;return typeof c=="object"&&!(c instanceof RegExp)?(Object.keys(c).forEach(function(y){if(typeof c[y]=="function")w.on(y,c[y]);else{var _=c[y],B=_.uses,Ie=_.as,Ae=_.hooks;i.push(f(y,B,[u,Ae],Ie))}}),this):(typeof c=="function"&&(E=h,h=c,c=o),i.push(f(c,h,[u,E])),this)}function g(c,h){if(a.__dirty){a.__waiting.push(function(){return a.resolve(c,h)});return}else a.__dirty=!0;c=c?T(o)+"/"+T(c):void 0;var E={instance:a,to:c,currentLocationPath:c,navigateOptions:{},resolveOptions:Y({},n,h)};return H([re,X,H.if(function(w){var y=w.matches;return y&&y.length>0},ce,se)],E,K),E.matches?E.matches:!1}function b(c,h){if(a.__dirty){a.__waiting.push(function(){return a.navigate(c,h)});return}else a.__dirty=!0;c=T(o)+"/"+T(c);var E={instance:a,to:c,navigateOptions:h||{},resolveOptions:h&&h.resolveOptions?h.resolveOptions:n,currentLocationPath:p(c)};H([ze,je,X,H.if(function(w){var y=w.matches;return y&&y.length>0},ce,se),Ve,K],E,K)}function C(c,h,E){var w=ne(c,h);return w!==null?(b(w.replace(new RegExp("^/?"+o),""),E),!0):!1}function L(c){return this.routes=i=i.filter(function(h){return z(c)?T(h.path)!==T(c):Fe(c)?c!==h.handler:String(h.path)!==String(c)}),this}function S(){l&&(this.__popstateListener=function(){a.__freezeListening||g()},window.addEventListener("popstate",this.__popstateListener))}function I(){this.routes=i=[],l&&window.removeEventListener("popstate",this.__popstateListener),this.destroyed=s=!0}function P(c,h){return a._notFoundRoute=f("*",c,[u,h],"__NOT_FOUND__"),this}function $(){if(m)return x().forEach(function(c){if(c.getAttribute("data-navigo")==="false"||c.getAttribute("target")==="_blank"){c.hasListenerAttached&&c.removeEventListener("click",c.navigoHandler);return}c.hasListenerAttached||(c.hasListenerAttached=!0,c.navigoHandler=function(h){if((h.ctrlKey||h.metaKey)&&h.target.tagName.toLowerCase()==="a")return!1;var E=c.getAttribute("href");if(typeof E>"u"||E===null)return!1;if(E.match(/^(http|https)/)&&typeof URL<"u")try{var w=new URL(E);E=w.pathname+w.search}catch{}var y=De(c.getAttribute("data-navigo-options"));s||(h.preventDefault(),h.stopPropagation(),a.navigate(T(E),y))},c.addEventListener("click",c.navigoHandler))}),a}function x(){return m?[].slice.call(document.querySelectorAll(n.linksSelector||le)):[]}function N(c){return"/"+o+"/"+T(c)}function W(c){return u=c,this}function F(){return r}function ne(c,h,E){var w=i.find(function(B){return B.name===c}),y=null;if(w){if(y=w.path,h)for(var _ in h)y=y.replace(":"+_,h[_]);y=y.match(/^\//)?y:"/"+y}return y&&E&&!E.includeRoot&&(y=y.replace(new RegExp("^/"+o),"")),y}function Se(c){return c.getAttribute("href")}function ae(c){var h=U(T(c)),E=h[0],w=h[1],y=w===""?null:J(w),_=j(c),B=f(E,function(){},[u],E);return{url:E,queryString:w,hashString:_,route:B,data:null,params:y}}function we(){return ae(T(ue(o)).replace(new RegExp("^"+o),""))}function Te(c){var h={instance:a,currentLocationPath:c,to:c,navigateOptions:{},resolveOptions:n};return X(h,function(){}),h.matches?h.matches:!1}function ke(c,h,E){typeof h<"u"&&(typeof E>"u"||E)&&(h=d(h));var w={instance:a,to:h,currentLocationPath:h};re(w,function(){}),typeof c=="string"&&(c=typeof E>"u"||E?d(c):c);var y=pe(w,{name:String(c),path:c,handler:function(){},hooks:{}});return y||!1}function G(c,h,E){return typeof h=="string"&&(h=oe(h)),h?(h.hooks[c]||(h.hooks[c]=[]),h.hooks[c].push(E),function(){h.hooks[c]=h.hooks[c].filter(function(w){return w!==E})}):(console.warn("Route doesn't exists: "+h),function(){})}function oe(c){return typeof c=="string"?i.find(function(h){return h.name===d(c)}):i.find(function(h){return h.handler===c})}function qe(c){c.instance.__dirty=!1,c.instance.__waiting.length>0&&c.instance.__waiting.shift()()}this.root=o,this.routes=i,this.destroyed=s,this.current=r,this.__freezeListening=!1,this.__waiting=[],this.__dirty=!1,this.__markAsClean=qe,this.on=v,this.off=L,this.resolve=g,this.navigate=b,this.navigateByName=C,this.destroy=I,this.notFound=P,this.updatePageLinks=$,this.link=N,this.hooks=W,this.extractGETParameters=function(c){return U(p(c))},this.lastResolved=F,this.generate=ne,this.getLinkPath=Se,this.match=Te,this.matchLocation=ke,this.getCurrentLocation=we,this.addBeforeHook=G.bind(this,"before"),this.addAfterHook=G.bind(this,"after"),this.addAlreadyHook=G.bind(this,"already"),this.addLeaveHook=G.bind(this,"leave"),this.getRoute=oe,this._pathToMatchObject=ae,this._clean=T,this._checkForAHash=p,this._setCurrent=function(c){return r=a.current=c},S.call(this),$.call(this)}const tt="https://eclipso-backend.vercel.app/api/v1",q=async(e,t="GET",n=null,a={})=>{const o=`${tt}${e}`,r={"Content-Type":"application/json",...a};console.log(a),n&&(n instanceof FormData?delete r["Content-Type"]:n=JSON.stringify(n));try{const i=await fetch(o,{method:t,headers:r,body:n});if(!i.ok)throw new Error(`Error: ${i.statusText}`);const s=await i.json();return console.log(s),s}catch(i){throw console.error("Request failed",i),i}},R=()=>{const e=localStorage.getItem("authToken"),t=localStorage.getItem("userName"),n=localStorage.getItem("email"),a=localStorage.getItem("userId");return console.log("Token disponible:",e),console.log("userName disponible:",t),console.log("email disponible:",n),console.log("userId disponible:",a),!!(e&&t&&n&&a)},ge=e=>{e.disabled=!0;const t=document.createElement("div");t.classList.add("loading-spinner"),e.appendChild(t)},Ee=e=>{e.disabled=!1;const t=e.querySelector(".loading-spinner");t&&t.remove()};function nt(e="¡Te has registrado correctamente!",t="Recibirás un correo con los detalles en tu bandeja de entrada."){const n=document.createElement("div");n.classList.add("modal","modal-success");const a=document.createElement("div");a.classList.add("icon"),a.innerHTML="✓";const o=document.createElement("h3");o.innerText=e;const r=document.createElement("p");r.innerText=t;const i=document.createElement("button");return i.classList.add("close-btn"),i.innerText="Cerrar",i.onclick=()=>V(n),n.appendChild(a),n.appendChild(o),n.appendChild(r),n.appendChild(i),n}function ye(e="¡Error al registrarse!",t="No se pudo completar tu registro. Por favor, intenta más tarde."){const n=document.createElement("div");n.classList.add("modal","modal-error");const a=document.createElement("div");a.classList.add("icon"),a.innerHTML="×";const o=document.createElement("h3");o.innerText=e;const r=document.createElement("p");r.innerText=t;const i=document.createElement("button");return i.classList.add("close-btn"),i.innerText="Cerrar",i.onclick=()=>V(n),n.appendChild(a),n.appendChild(o),n.appendChild(r),n.appendChild(i),n}function at(){const e=document.createElement("div");return e.classList.add("modal-overlay"),e.onclick=()=>V(),e}function k(e,t,n){const a=at();document.body.appendChild(a);let o;e==="success"?o=nt(t,n):e==="error"&&(o=ye(t,n)),document.body.appendChild(o),o.classList.add("show"),setTimeout(()=>{V(o)},5e3)}function V(e){const t=document.querySelector(".modal-overlay");e&&e.remove(),t&&t.remove()}const ot=e=>{const t=()=>{const g=document.getElementById("modal-container");g&&(g.innerHTML="",g.style.display="none")},n=document.createElement("div");n.classList.add("form-container");const a=document.createElement("div");a.classList.add("modal-overlay"),a.addEventListener("click",t);const o=document.createElement("form");o.id="form-registro";const r=document.createElement("h2");r.textContent="Registro al Evento",o.appendChild(r);const i=document.createElement("div"),s=document.createElement("label");s.setAttribute("for","userName"),s.textContent="Nombre";const u=document.createElement("input");u.id="userName",u.type="text",u.required=!0,i.appendChild(s),i.appendChild(u),o.appendChild(i);const l=document.createElement("div"),m=document.createElement("label");m.setAttribute("for","email"),m.textContent="Email";const p=document.createElement("input");p.id="email",p.type="email",p.required=!0,l.appendChild(m),l.appendChild(p),o.appendChild(l);const d=document.createElement("button");d.classList.add("asistencia-button"),d.id="boton-registro-evento",d.type="submit",d.textContent="Registrar",o.appendChild(d),n.appendChild(o),o.addEventListener("submit",async function(g){g.preventDefault();const b=u.value.trim(),C=p.value.trim();if(!b||!C)return;ge(d);const L={userName:b,email:C};try{const S=await q(`/asistentes/eventos/${e}/confirmar`,"POST",L),I=(S==null?void 0:S.mensaje)||"Hubo un problema al confirmar la asistencia.";I.includes("éxito")?k("success","¡Asistencia confirmada!",I):(k("error","¡Error al confirmar!",I),console.error(I))}catch(S){k("error","¡Error de conexión!","No se pudo completar la acción. Por favor, intenta más tarde."),console.error("Error al intentar confirmar la asistencia:",S)}finally{Ee(d)}});const f=document.getElementById("modal-container");f&&(f.innerHTML="",f.appendChild(a),f.appendChild(n),f.style.display="block");const v=document.createElement("button");return v.textContent="Cerrar",v.classList.add("close-modal-button"),v.addEventListener("click",t),n.appendChild(v),n},rt=(e,t,n)=>{const a=document.createElement("div");a.classList.add("events-grid");const o=e.filter(r=>{const i=n?r.titulo.toLowerCase().includes(n.toLowerCase()):!0,s=t.tags?r.etiquetas.includes(t.tags):!0,u=r.precio>=t.priceRange[0]&&r.precio<=t.priceRange[1];return i&&s&&u});return o.length===0?a.innerHTML="<p>No se han encontrado eventos con estos filtros.</p>":(o.forEach(r=>{const i=document.createElement("div");i.classList.add("event-card"),i.innerHTML=`
  <h3 class="event-title">${r.titulo}</h3>
  <div class="event-img-container">
    <img src="${r.cartel}" alt="${r.titulo}">
  </div>
  <div class="favorite-container">
    <svg class="favorite-icon" data-event-id="${r._id}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-label="Añadir a favoritos">
  <defs>
    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color: #29253a; stop-opacity: 1" />
      <stop offset="32%" style="stop-color: #44107a; stop-opacity: 1" />
      <stop offset="67%" style="stop-color: #ff1361; stop-opacity: 1" />
      <stop offset="100%" style="stop-color: #fff800; stop-opacity: 1" />
    </linearGradient>
  </defs>
  <path class="heart-outline" fill="none" stroke="currentColor" stroke-width="2" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
  <path class="heart-filled" fill="url(#gradient)" style="opacity: 0;" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
</svg>
  </div>
  <p class="date">${new Date(r.fecha).toLocaleDateString("es-ES")}</p>
  <p class="description">${r.descripcion}</p>
  <p class="price">${r.precio?`Precio: ${r.precio}€`:"Gratis"}</p>
      ${r.etiquetas&&r.etiquetas.length>0&&r.etiquetas[0]!==""?`<div class="tags-event-container">
          ${r.etiquetas.map(m=>`<span class="tag-badge"> • ${m}</span>`).join(" ")}
        </div>`:""}
  <div class="button-event-container">
    <button class="asistencia-button" data-event-id="${r._id}">Quiero ir</button>
  </div>
`;const s=i.querySelector(".favorite-icon"),u=s.querySelector(".heart-filled");localStorage.getItem(r._id)==="true"&&(s.classList.add("liked"),u.style.opacity=1),a.appendChild(i)}),setTimeout(ee,0)),a.addEventListener("click",r=>{const i=r.target.closest(".favorite-icon");if(i){const s=i.dataset.eventId;it(i,s)}if(r.target.classList.contains("asistencia-button")){const s=r.target.dataset.eventId;st(s)}}),a},it=async(e,t)=>{const n=e.querySelector(".heart-filled"),a=localStorage.getItem("authToken"),o=localStorage.getItem("userId"),r={Authorization:`Bearer ${a}`},i={userId:o,eventId:t};try{const s=await q(`/auth/${t}/favourite`,"POST",i,r);s.message==="Evento agregado a la lista de favoritos"?(e.classList.add("liked"),n.style.opacity=1,localStorage.setItem(`${o}-${t}`,"true"),k("success","Listo!",s.message)):s.message==="Evento eliminado de la lista de favoritos"&&(e.classList.remove("liked"),n.style.opacity=0,localStorage.removeItem(`${o}-${t}`),k("success","Listo!",s.message))}catch(s){console.error("Error al actualizar favorito:",s),k("error","Ha habido un error","Hubo un error al procesar tu solicitud. Inténtalo de nuevo.")}};document.addEventListener("DOMContentLoaded",()=>{console.log("DOM completamente cargado"),ee()});const ee=async()=>{const e=document.querySelectorAll(".favorite-icon");if(e.length===0)return;const t=localStorage.getItem("userId");if(!t){console.error("No se encontró el userId en el localStorage");return}e.forEach(n=>{const a=n.getAttribute("data-event-id"),o=localStorage.getItem(`${t}-${a}`)==="true",r=n.querySelector(".heart-filled");o?(n.classList.add("liked"),r&&(r.style.opacity=1)):(n.classList.remove("liked"),r&&(r.style.opacity=0))})},st=async e=>{if(R()){const t=localStorage.getItem("authToken"),n=localStorage.getItem("userId"),a=localStorage.getItem("userName"),o=localStorage.getItem("email");if(!t){console.error("Token no encontrado en localStorage");return}if(a&&o){const r={userName:a,email:o};R()&&(r.userId=n);try{const i={Authorization:`Bearer ${t}`};console.log("Headers sent:",i);const s=await q(`/asistentes/eventos/${e}/confirmar`,"POST",r,i),u=(s==null?void 0:s.mensaje)||"Hubo un problema al confirmar la asistencia.";u.includes("éxito")?k("success","¡Asistencia confirmada!",u):(k("error","¡Error al confirmar!",u),console.error(u))}catch(i){k("error","¡Error de conexión!","No se pudo completar la acción. Por favor, intenta más tarde."),console.error("Error al intentar confirmar la asistencia:",i)}}else k("error","Datos erróneos","No se encontraron datos del usuario."),console.error("No se encontraron datos de usuario en localStorage.")}else{console.log("Usuario no autenticado");const t=ot(e);let n=document.getElementById("modal-container");n||(n=document.createElement("div"),n.id="modal-container",document.body.appendChild(n)),n.innerHTML="",n.appendChild(t)}},ct=(e,t,n)=>{const a=L=>{(L.type==="blur"||L.key==="Enter")&&e(L.target.value)};let o=!1;const r=()=>{o=!o,f.style.display=o?"flex":"none"};let i=!1;const s=()=>{i=!i,g.style.display=i?"block":"none"},u=L=>{const S=document.getElementById("costValue");S.innerText=L.target.value,t("priceRange",[0,parseInt(L.target.value)])},l=document.createElement("div");l.classList.add("search-filter-container");const m=document.createElement("input");m.type="text",m.classList.add("search-bar"),m.placeholder="Busca eventos...",m.addEventListener("blur",a),m.addEventListener("keypress",a);const p=document.createElement("div");p.classList.add("filters");const d=document.createElement("button");d.classList.add("theme"),d.innerText="Filtra por temática",d.addEventListener("click",r);const f=document.createElement("div");f.classList.add("theme-options"),f.style.display="none",n.forEach(L=>{const S=document.createElement("button");S.classList.add("theme-option"),S.innerText=L,S.addEventListener("click",()=>t("tags",L)),f.appendChild(S)});const v=document.createElement("button");v.classList.add("cost"),v.innerText="Filtra por coste",v.addEventListener("click",s);const g=document.createElement("div");g.classList.add("cost-slider"),g.style.display="none";const b=document.createElement("input");b.type="range",b.min=0,b.max=1e3,b.value=1e3,b.classList.add("slider"),b.addEventListener("input",u);const C=document.createElement("label");return C.innerHTML='Coste: <span id="costValue">1000</span>',g.appendChild(b),g.appendChild(C),l.appendChild(m),p.appendChild(d),p.appendChild(f),p.appendChild(v),p.appendChild(g),l.appendChild(p),l},de=async()=>{const e=document.querySelector("#app");let t=document.querySelector(".page-container");t||(t=document.createElement("div"),t.classList.add("page-container"),e.appendChild(t));let n="",a={tags:"",priceRange:[0,1e3]};const o=async()=>{try{const l=await q("/eventos/");if(Array.isArray(l)){const m=new Set;return l.forEach(p=>p.etiquetas.forEach(d=>m.add(d))),Array.from(m)}else return console.error("La respuesta no es un array",l),[]}catch(l){return console.error("Error fetching tags:",l),[]}},r=l=>{n=l.trim(),s()},i=(l,m)=>{a[l]=m,s()},s=async()=>{try{const l=new URLSearchParams({search:n,tags:a.tags||"",costMin:a.priceRange[0],costMax:a.priceRange[1]}),m=await q(`/eventos/filtros?${l.toString()}`);if(Array.isArray(m)){const p=await o();u(m,p)}else console.error("La respuesta de eventos filtrados no es un array",m)}catch(l){console.error("Error fetching filtered events:",l)}},u=(l,m)=>{t.innerHTML="";const p=ct(r,i,m);if(p instanceof Node){t.appendChild(p);const d=rt(l,a,n);t.appendChild(d)}else console.error("El SearchAndFilterComponent no devolvió un nodo válido.")};await o(),s()},lt=e=>{const t=document.querySelector(".page-container"),n=document.createElement("section");n.classList.add("faq-section");const a=document.createElement("h2");a.textContent="Preguntas Frecuentes",a.classList.add("faq-title"),n.appendChild(a);const o=document.createElement("div");o.classList.add("faq-grid"),e.forEach(r=>{const i=document.createElement("div");i.classList.add("faq-card");const s=document.createElement("h3");s.textContent=r.question,s.classList.add("faq-question");const u=document.createElement("p");u.textContent=r.answer,u.classList.add("faq-answer"),u.style.display="none",s.addEventListener("click",()=>{const l=u.style.display==="block";u.style.display=l?"none":"block",i.classList.toggle("active",!l)}),i.appendChild(s),i.appendChild(u),o.appendChild(i)}),n.appendChild(o),t.appendChild(n)},dt=()=>{const e=document.querySelector(".page-container"),t=document.createElement("div");t.classList.add("testimonial-section");const n=document.createElement("p");n.innerText="Lo que dicen sobre nosotros",n.classList.add("testimonial-subtitle");const a=document.createElement("div");a.classList.add("testimonial-container"),[{avatar:"/avatar1.webp",text:"La organización de los eventos es excepcional, siempre me siento inspirado y conectado con la comunidad.",name:"Carlos Martínez"},{avatar:"/avatar2test.webp",text:"Un espacio donde compartir conocimientos y aprender de otras expertas locales. ¡Es increíble!",name:"Laura Gómez"},{avatar:"/avatar3.webp",text:"Participar en los eventos culturales está siendo una experiencia transformadora. Me encanta formar parte de esta red.",name:"Ana López"}].forEach(({avatar:r,text:i,name:s})=>{const u=document.createElement("div");u.classList.add("testimonial-box");const l=document.createElement("img");l.src=r,l.alt=`${s}'s avatar`,l.classList.add("testimonial-avatar");const m=document.createElement("p");m.innerText=i,m.classList.add("testimonial-text");const p=document.createElement("span");p.innerText=s,p.classList.add("testimonial-name"),u.appendChild(l),u.appendChild(m),u.appendChild(p),a.appendChild(u)}),t.appendChild(n),t.appendChild(a),e.appendChild(t)},ut=()=>{const e=document.querySelector(".page-container");if(!e){console.error("No se encontró el contenedor .page-container");return}const t=document.createElement("div");t.classList.add("title-container");const n=document.createElement("h1");n.classList.add("title"),n.innerText="Eclipso",t.append(n),e.appendChild(t)},pt=[{question:"¿Dónde se realizan los eventos?",answer:"Los eventos se realizan en el lugar elegido por quien los organiza. Podrás ver la dirección exacta en la página de cada evento."},{question:"¿Hay un horario fijo para los eventos?",answer:"No, cada organizador/a decide el horario de su evento. Consulta los detalles específicos en la página del evento que te interese."},{question:"¿Debo registrarme para participar u organizar un evento?",answer:"Sí, necesitas crear una cuenta en nuestra web para organizar eventos o unirte como asistente."}],D=()=>{const e=document.getElementById("app");let t=document.querySelector(".page-container");if(!t)t=document.createElement("div"),t.classList.add("page-container"),e.appendChild(t);else{const L=t.querySelector(".grid");L&&(L.innerHTML="")}ut();const n=document.createElement("div");n.classList.add("landing-container");const a=document.createElement("div");a.classList.add("grid");const o=document.createElement("div");o.classList.add("box"),o.style.gridColumn="span 2",o.style.gridRow="span 1";const r=document.createElement("p");r.innerHTML="Descubra <strong>eventos cerca de ti</strong> para compartir conocimientos, inspirarse y crecer junto a su comunidad.",o.appendChild(r);const i=document.createElement("div");i.classList.add("box"),i.style.gridColumn="span 2",i.style.gridRow="span 1";const s=document.createElement("p");s.innerHTML="Explora los momentos más destacados de eventos pasados y planifique su participación en los próximos encuentros.",i.appendChild(s);const u=document.createElement("div");u.classList.add("box"),u.style.gridColumn="span 1",u.style.gridRow="span 3";const l=document.createElement("p");l.innerHTML="<strong>¿Tienes una pasión o idea que quieras compartir?</strong> Propon tu evento ideal y lo haremos posible.";const m=document.createElement("button");m.classList.add("contact-button"),m.innerText="Contactanos",u.append(l,m);const p=document.createElement("div");p.classList.add("box"),p.style.gridColumn="span 2",p.style.gridRow="span 3";const d=document.createElement("img");d.src="/movie-night.webp";const f=document.createElement("p");f.innerHTML="Únase a una red vibrante de colaboradores, desde <strong>gente con ganas de compartir y pasar un buen rato</strong> hasta <strong>expertos locales y líderes de la comunidad.</strong>",p.appendChild(d),p.appendChild(f);const v=document.createElement("div");v.classList.add("box"),v.style.gridColumn="span 1",v.style.gridRow="span 3";const g=document.createElement("img");g.src="/backyard-party-lighting.webp";const b=document.createElement("p");b.innerHTML="<strong>Regístrate ahora</strong> y asegure su lugar en el próximo evento diseñado para inspirar e innovar.";const C=document.createElement("button");C.classList.add("register-landing-button"),C.innerText="Regístrate ahora",C.onclick=()=>{window.location.href="/registro"},v.appendChild(g),v.appendChild(b),v.appendChild(C),a.appendChild(o),a.appendChild(i),a.appendChild(u),a.appendChild(p),a.appendChild(v),n.appendChild(a),t.appendChild(n),dt(),lt(pt)},Le=()=>{const e=document.getElementById("app");let t=document.getElementById("loader-container");if(!t){t=document.createElement("div"),t.id="loader-container",t.classList.add("loader-container");const n=document.createElement("div");n.classList.add("spinner"),t.appendChild(n),e.appendChild(t)}},be=()=>{const e=document.getElementById("loader-container");e&&e.remove()},mt=e=>{localStorage.setItem("authToken",e)},ft=(e,t,n)=>{localStorage.setItem("userName",e),localStorage.setItem("email",t),localStorage.setItem("userId",n)},Ce=async(e,t)=>{try{console.log("Iniciando login con:",{email:e,password:t});const n=document.querySelector(".login-container");n&&n.remove();const a=document.querySelector(".register-container"),o=document.querySelector(".login-text");a&&o&&(a.remove(),o.remove()),Le();const r=await q("/auth/login","POST",{email:e,password:t});return console.log("Respuesta del backend:",r),r.token?(mt(r.token),r.usuario&&(console.log("Datos de usuario recibidos:",r.usuario),ft(r.usuario.userName,r.usuario.email,r.usuario._id),window.location.reload(),O.navigate("/explora")),r):(console.warn("No se recibió token en la respuesta."),!1)}catch(n){return console.error("Error al iniciar sesión:",n),!1}finally{be()}},ht=()=>{const e=document.querySelector(".page-container");e.innerHTML="";const t=document.createElement("div");t.classList.add("login-container"),e.append(t);const n=document.createElement("h2");n.classList.add("login-title"),n.innerText="Inicia sesión";const a=document.createElement("form");a.classList.add("login-form");const o=document.createElement("input");o.classList.add("email-input"),o.setAttribute("type","email"),o.setAttribute("placeholder","Correo electrónico");const r=document.createElement("input");r.classList.add("password-input"),r.setAttribute("type","password"),r.setAttribute("placeholder","Contraseña");const i=document.createElement("button");i.classList.add("login-button"),i.innerText="Iniciar sesión";const s=document.createElement("p");s.classList.add("register-text"),s.innerHTML='¿No tienes cuenta? <a href="#" class="register-link">Regístrate aquí</a>',s.querySelector(".register-link").addEventListener("click",l=>{l.preventDefault(),O.navigate("/registro")}),i.addEventListener("click",l=>{l.preventDefault();const m=o.value,p=r.value;Ce(m,p).then(d=>{d&&d.token?(O.navigate("/"),window.location.reload()):alert("Credenciales incorrectas")}).catch(d=>{alert("Hubo un problema con el inicio de sesión")})}),a.append(o,r,i,s),t.append(n,a)},vt=async(e,t,n,a,o)=>{try{const r=await q("/auth/register","POST",{userName:e,email:t,password:n,phone:a,birthdate:o});console.log(r),r&&(Ce(t,n),console.log(r))}catch(r){console.error("Error al iniciar sesión:",r)}},gt=()=>{const e=document.querySelector(".page-container");e.innerHTML="";const t=document.createElement("div");t.classList.add("register-container"),e.append(t);const n=document.createElement("h2");n.classList.add("register-title"),n.innerText="Nueva cuenta",t.append(n);const a=document.createElement("p");a.classList.add("login-text"),a.innerHTML='¿Ya tienes cuenta? <a href="#" class="login-link">Entra aquí</a>',a.querySelector(".login-link").addEventListener("click",m=>{m.preventDefault(),O.navigate("/acceder")}),e.append(a);const r=document.createElement("div");r.classList.add("form-slider"),t.append(r);const i=[{inputs:[{type:"text",placeholder:"Nombre completo",className:"name-input",name:"name"}]},{inputs:[{type:"email",placeholder:"Correo electrónico",className:"email-input",name:"email"},{type:"password",placeholder:"Contraseña",className:"password-input",name:"password"},{type:"password",placeholder:"Confirmar contraseña",className:"confirm-password-input",name:"confirmPassword"}]},{inputs:[{type:"tel",placeholder:"Teléfono (opcional)",className:"phone-input",name:"phone"},{type:"date",placeholder:"Fecha de nacimiento",className:"birthdate-input",name:"birthdate"}]}];let s=0,u={};const l=()=>{r.innerHTML="";const m=document.createElement("form");m.classList.add("form-step"),r.append(m),i[s].inputs.forEach(d=>{const f=document.createElement("input");f.type=d.type,f.placeholder=d.placeholder,f.classList.add(d.className),f.setAttribute("name",d.name),u[d.name]&&(f.value=u[d.name]),f.addEventListener("input",v=>{u[d.name]=v.target.value}),m.append(f)});const p=document.createElement("div");if(p.classList.add("form-controls"),s>0){const d=document.createElement("button");d.innerText="Anterior",d.classList.add("prev-button"),d.addEventListener("click",f=>{f.preventDefault(),s--,l()}),p.append(d)}if(s<i.length-1){const d=document.createElement("button");d.innerText="Siguiente",d.classList.add("next-button"),d.addEventListener("click",f=>{f.preventDefault(),s++,l()}),p.append(d)}else{const d=document.createElement("button");d.innerText="Registrar",d.classList.add("submit-button"),d.type="submit",m.append(d),m.addEventListener("submit",f=>{f.preventDefault();const{name:v,email:g,password:b,confirmPassword:C,phone:L,birthdate:S}=u;b!==C?alert("Las contraseñas no coinciden"):vt(v,g,b,L,S)}),p.append(d)}m.append(p)};l()},Et=()=>{console.log("Me estoy desconectando!!!!"),localStorage.removeItem("authToken"),localStorage.removeItem("userName"),localStorage.removeItem("email"),localStorage.removeItem("userId"),Le(),window.location.reload(),be()},yt=e=>{const t=document.querySelector(".event-form");if(t)return t;const n=document.createElement("div");n.classList.add("create-event-container");const a=document.createElement("form");a.classList.add("event-form");const o=document.createElement("label");o.setAttribute("for","titulo"),o.textContent="Título del evento";const r=document.createElement("input");r.id="titulo",r.name="titulo",r.type="text",r.required=!0;const i=document.createElement("label");i.setAttribute("for","fecha"),i.textContent="Fecha del evento";const s=document.createElement("input");s.id="fecha",s.name="fecha",s.type="datetime-local",s.required=!0;const u=document.createElement("label");u.setAttribute("for","ubicacion"),u.textContent="Ubicación del evento";const l=document.createElement("input");l.id="ubicacion",l.name="ubicacion",l.type="text",l.required=!0;const m=document.createElement("label");m.setAttribute("for","descripcion"),m.textContent="Descripción del evento";const p=document.createElement("textarea");p.id="descripcion",p.name="descripcion",p.rows="4",p.cols="50";const d=document.createElement("label");d.setAttribute("for","precio"),d.textContent="Precio del evento";const f=document.createElement("input");f.id="precio",f.name="precio",f.type="number",f.min="0",f.value="0";const v=document.createElement("label");v.setAttribute("for","cartel"),v.textContent="Imagen del evento (opcional)";const g=document.createElement("input");g.id="cartel",g.name="cartel",g.type="file",g.accept="image/*",v.classList.add("file-upload-label");const b=document.createElement("span");b.classList.add("file-upload-info"),b.textContent="Ningún archivo seleccionado",g.addEventListener("change",()=>{b.textContent=g.files.length?g.files[0].name:"Ningún archivo seleccionado"});const C=document.createElement("label");C.setAttribute("for","etiquetas"),C.textContent="Etiquetas (opcional)";const L=document.createElement("input");L.id="etiquetas",L.name="etiquetas",L.type="text",L.placeholder="Agregar etiquetas separadas por comas";const S=document.createElement("button");return S.type="submit",S.textContent="Crear Evento",a.appendChild(o),a.appendChild(r),a.appendChild(i),a.appendChild(s),a.appendChild(u),a.appendChild(l),a.appendChild(m),a.appendChild(p),a.appendChild(d),a.appendChild(f),a.appendChild(v),a.appendChild(g),a.appendChild(b),a.appendChild(C),a.appendChild(L),a.appendChild(S),a.addEventListener("submit",async I=>{I.preventDefault();const P=new FormData(a);(!P.has("cartel")||P.get("cartel")==="")&&P.set("cartel","/ticket-retro.webp");const x={Authorization:`Bearer ${localStorage.getItem("authToken")}`};ge(S);try{const N=await q(`/auth/${e}/create`,"POST",P,x);console.log("Evento creado con éxito:",N),k("success","¡Evento creado con éxito!","¡Enhorabuena!")}catch(N){console.error("Error al crear el evento:",N),k("error","Error al crear el evento","Inténtalo más tarde")}finally{Ee(S)}}),n.appendChild(a),n},Lt=async e=>{const t=document.createElement("div");t.classList.add("modal-no-events");try{const n=await q(`/eventos/${e}`,"GET"),a=new Date(n.fecha).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/").reverse().join("-");t.innerHTML=`
  <div class="event-card" id="modal-event-card">
    <h2 id="modal-title">Editar Evento</h2>
    
    <div class="event-header" id="event-header">
      <h3 class="event-title" id="title-label">Título:</h3>
      <p id="title-value">${n.titulo}</p>
      <input type="text" id="title" name="titulo" value="${n.titulo}" />
    </div>

    <div class="event-info" id="description-container">
      <h3 id="description-label">Descripción:</h3>
      <p id="description-value">${n.descripcion}</p>
      <textarea id="description" name="descripcion">${n.descripcion}</textarea>
    </div>

    <div class="event-img-container" id="image-container">
      <h3 id="image-label">Imagen:</h3>
      <img src="${n.cartel}" alt="${n.titulo}" id="image-preview" />
      <input type="file" id="image" name="cartel" accept="image/*" />
      <label for="image" class="file-upload-label" id="image-upload-label">Seleccionar Imagen</label>
    </div>

    <div class="event-info" id="date-container">
      <h3 id="date-label">Fecha:</h3>
      <p id="date-value">${new Date(n.fecha).toLocaleDateString("es-ES")}</p>
      <input type="date" id="date" name="fecha" value="${a}" />
    </div>

    <div class="event-info" id="price-container">
      <h3 id="price-label">Precio:</h3>
      <p id="price-value">${n.precio?`${n.precio}€`:"Gratis"}</p>
      <input type="number" id="price" name="precio" value="${n.precio||""}" />
    </div>

    <div class="tags-event-container" id="tags-container">
      <h3 id="tags-label">Etiquetas:</h3>
      <p id="tags-value">${n.etiquetas?n.etiquetas.join(", "):"No tiene etiquetas"}</p>
      <input type="text" id="tags" name="etiquetas" value="${n.etiquetas?n.etiquetas.join(", "):""}" />
    </div>

    <div class="modal-footer" id="modal-footer">
      <button type="button" id="saveChangesBtn">Guardar cambios</button>
      <button type="button" id="cancelBtn">Cancelar</button>
      <button type="button" id="deleteBtn" class="delete-button">Eliminar evento</button>
    </div>
  </div>
`;const o=t.querySelector("#saveChangesBtn"),r=t.querySelector("#cancelBtn"),i=t.querySelector("#deleteBtn");o.onclick=async()=>{const s={titulo:t.querySelector("#title").value,descripcion:t.querySelector("#description").value,fecha:t.querySelector("#date").value,precio:t.querySelector("#price").value||0,etiquetas:t.querySelector("#tags").value.trim()||""};console.log("Datos antes de enviar al backend:",s);const u=t.querySelector("#image"),l=new FormData;l.append("titulo",s.titulo),l.append("descripcion",s.descripcion),l.append("fecha",s.fecha),l.append("precio",s.precio),l.append("etiquetas",s.etiquetas),u.files[0]?(l.append("cartel",u.files[0]),console.log("Archivo de imagen:",u.files[0])):console.log("No se seleccionó una nueva imagen. Usando imagen actual..."),console.log("FormData antes de hacer la petición:"),l.forEach((f,v)=>{console.log(v,f)});const m=localStorage.getItem("authToken"),p=localStorage.getItem("userId"),d={Authorization:`Bearer ${m}`};try{const f=await q(`/eventos/${e}/auth/${p}`,"PATCH",l,d);console.log(f),k("success","¡Enhorabuena!","Evento modificado correctamente"),t.remove()}catch(f){k("error","¡Vaya!","Ha habido un error al modificar el evento. Inténtalo más tarde"),console.error("Error al actualizar el evento:",f)}},r.onclick=()=>{t.remove()},i.onclick=async()=>{const u={Authorization:`Bearer ${localStorage.getItem("authToken")}`};try{const l=await q(`/eventos/${e}`,"DELETE",null,u);console.log(l),k("success","¡Enhorabuena!","Evento eliminado correctamente"),t.remove()}catch(l){console.error("Error al eliminar el evento:",l),k("error","¡Vaya!","Ha habido un error al eliminar el evento. Inténtalo más tarde")}},document.body.appendChild(t)}catch(n){console.error("Error al obtener los datos del evento:",n),ye("¡Vaya!","Error al obtener los datos del evento")}},bt=async e=>{const t=document.querySelector(".page-container"),n=document.createElement("div");n.classList.add("events-grid"),n.id="my-events-grid";try{const a=await q(`/auth/${e}`,"GET");return console.log(a.eventosOrganizados),a.eventosOrganizados.forEach(o=>{const r=document.createElement("div");r.classList.add("event-card"),r.innerHTML=`
      <div class="event-header">
        <h3 class="event-title">${o.titulo}</h3>
        <button class="edit-event-btn" data-event-id="${o._id}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
            <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"></path>
            <path d="M13.5 6.5l4 4"></path>
          </svg>
          <span class="tooltip-text">Editar</span>
        </button>
      </div>
      <div class="event-img-container">
        <img src="${o.cartel}" alt="${o.titulo}">
      </div>
      <p class="date">${new Date(o.fecha).toLocaleDateString("es-ES")}</p>
      <p class="description">${o.descripcion}</p>
      <p class="price" id="precio">${o.precio?`Precio: ${o.precio}€`:"Gratis"}</p>
      ${o.etiquetas&&o.etiquetas.length>0&&o.etiquetas[0]!==""?`<div class="tags-event-container">
          ${o.etiquetas.map(s=>`<span class="tag-badge"> • ${s}</span>`).join(" ")}
        </div>`:""}
    `;const i=r.querySelector(".edit-event-btn");i.addEventListener("click",()=>{const s=i.getAttribute("data-event-id");console.log(s),Lt(s)}),n.appendChild(r)}),n}catch(a){console.error("Error al obtener los datos del usuario:",a),t.innerHTML="<h1>Hubo un problema al cargar los datos del usuario.</h1>"}},Ct=async e=>{const t=document.querySelector(".page-container"),n=document.createElement("div");n.classList.add("events-grid"),n.id="my-favorite-events-grid";try{const a=await q(`/auth/${e}`,"GET");if(console.log(a.eventosFavoritos),a.eventosFavoritos.length===0){const o=document.createElement("div");return o.classList.add("modal-no-events"),o.innerHTML=`
        <div class="modal-no-events-content">
          <p>Aún no tienes eventos favoritos</p>
        </div>
      `,t.appendChild(o),setTimeout(()=>{o.remove()},3e3),null}else return a.eventosFavoritos.forEach(o=>{const r=document.createElement("div");r.classList.add("event-card"),r.innerHTML=`
          <h3 class="event-title">${o.titulo}</h3>
          <div class="event-img-container">
            <img src="${o.cartel}" alt="${o.titulo}">
          </div>
          <p class="date">${new Date(o.fecha).toLocaleDateString("es-ES")}</p>
          <p class="description">${o.descripcion}</p>
          <p class="price" id="precio">${o.precio?`Precio: ${o.precio}€`:"Gratis"}</p>
          ${o.etiquetas&&o.etiquetas.length>0&&o.etiquetas[0]!==""?`<div class="tags-event-container">
              ${o.etiquetas.map(i=>`<span class="tag-badge"> • ${i}</span>`).join(" ")}
            </div>`:""}
        `,n.appendChild(r)}),n}catch(a){console.error("Error al obtener los datos del usuario:",a),t.innerHTML="<h1>Hubo un problema al cargar los datos del usuario.</h1>"}},St=async()=>{const e=document.querySelector(".page-container");e.innerHTML="";const t=localStorage.getItem("userId");if(!t){console.error("No se encontró el userId en el localStorage"),e.innerHTML="<h1>No estás autenticado</h1>";return}try{const n=await q(`/auth/${t}`,"GET"),a=document.createElement("div");a.classList.add("my-events-container");const o=document.createElement("div");o.classList.add("avatar-container");const r=document.createElement("img");r.classList.add("user-avatar"),r.src=n.img||"usuario-avatar.webp",r.alt="Avatar de Usuario",o.appendChild(r);const i=document.createElement("h3");i.textContent=`Hola ${n.userName}, aquí puedes gestionar tus eventos.`;const s=document.createElement("div");s.classList.add("buttons-container");const u=document.createElement("button");u.textContent="Crear Evento",u.classList.add("my-events-button"),u.addEventListener("click",()=>{console.log("Crear un evento");const p=document.querySelector(".create-event-container");p&&p.remove();const d=document.querySelector("#my-events-grid");d&&d.remove();const f=document.querySelector("#my-favorite-events-grid");f&&f.remove(),e.appendChild(yt(t))});const l=document.createElement("button");l.textContent=" Mis Eventos",l.classList.add("my-events-button"),l.addEventListener("click",async()=>{console.log("Ver mis eventos organizados");const p=document.querySelector(".event-form");p&&p.remove();try{const d=document.querySelector("#my-events-grid");d&&d.remove();const f=document.querySelector("#my-favorite-events-grid");f&&f.remove();const v=document.querySelector(".title-no-events");v&&v.remove();const g=await bt(t);e.appendChild(g)}catch(d){console.error("Error al cargar la cuadrícula de eventos:",d)}});const m=document.createElement("button");m.textContent="Eventos Favoritos",m.classList.add("my-events-button"),m.addEventListener("click",async()=>{console.log("Ver mis eventos favoritos");try{const p=document.querySelector("#my-events-grid");p&&p.remove();const d=document.querySelector(".event-form");d&&d.remove();const f=document.querySelector("#my-favorite-events-grid");f&&f.remove();const v=await Ct(t);v&&e.appendChild(v)}catch(p){console.error("Error al cargar la cuadrícula de eventos:",p)}}),s.appendChild(u),s.appendChild(l),s.appendChild(m),a.appendChild(o),a.appendChild(i),a.appendChild(s),e.appendChild(a)}catch(n){console.error("Error al obtener los datos del usuario:",n),e.innerHTML="<h1>Hubo un problema al cargar los datos del usuario.</h1>"}},wt=async()=>{const e=document.querySelector(".page-container");e.innerHTML="";const t=document.createElement("div");t.classList.add("profile-container");const n=localStorage.getItem("userId"),a=await q(`/auth/${n}`,"GET"),o=document.createElement("div");o.classList.add("bento-grid");const r=document.createElement("div");r.style.gridColumn="span 2",r.style.gridRow="span 1",r.classList.add("bento-item","avatar-container");const i=document.createElement("img");i.src=a.img||"usuario-avatar.webp";const s=document.createElement("input");s.id="img",s.name="img",s.type="file",s.accept="image/*",s.style.display="none";const u=document.createElement("label");u.setAttribute("for","img"),u.textContent="Cambiar imagen",u.classList.add("file-upload-label"),r.append(i,s,u);const l=document.createElement("div");l.classList.add("bento-item");const m=document.createElement("label");m.textContent="Nombre:";const p=document.createElement("input");p.classList.add("profile-input"),p.type="text",p.name="userName",p.value=a.userName||"",l.append(m,p);const d=document.createElement("div");d.classList.add("bento-item");const f=document.createElement("label");f.textContent="Teléfono:";const v=document.createElement("input");v.classList.add("profile-input"),v.type="tel",v.name="phone",v.value=a.phone||"",d.append(f,v);const g=document.createElement("div");g.classList.add("bento-item");const b=document.createElement("label");b.textContent="Nueva contraseña:";const C=document.createElement("input");C.classList.add("profile-input"),C.type="password",C.name="newPassword",C.value="",g.append(b,C);const L=document.createElement("div");L.classList.add("bento-item");const S=document.createElement("label");S.textContent="Confirmar contraseña:";const I=document.createElement("input");I.classList.add("profile-input"),I.type="password",I.name="confirmPassword",I.value="",L.append(S,I);const P=document.createElement("div");P.style.gridColumn="span 2",P.style.gridRow="span 1";const $=document.createElement("button");$.textContent="Editar perfil",$.classList.add("edit-profile-button"),P.appendChild($),o.append(r,l,d,g,L,P),t.appendChild(o),e.appendChild(t),$.addEventListener("click",async()=>{const x=new FormData;if(x.append("userName",p.value),x.append("phone",v.value),C.value!==I.value){k("error","¡Vaya!","Las contraseñas no coinciden");return}C.value&&x.append("password",C.value),s.files.length>0&&x.append("img",s.files[0]);const W={Authorization:`Bearer ${localStorage.getItem("authToken")}`};try{const F=await q(`/auth/${n}`,"PATCH",x,W);console.log(F),k("success","¡Bien hecho!","Tu perfil se ha editado correctamente")}catch(F){console.error(F),k("error","¡Vaya!","Ha habido un error al editar tu perfil")}})},Tt=document.getElementById("app"),te=document.createElement("div");te.classList.add("page-container");Tt.appendChild(te);const O=new et("/",{hash:!0});O.on("/",()=>{R()?A(de):A(D)}).on("/comunidad",()=>{A(D)}).on("/acceder",()=>{A(ht)}).on("/registro",()=>{A(gt)}).on("/salir",()=>{Et(),A(D)}).on("/explora",()=>{A(de)}).on("/mis-eventos",()=>{R()?A(St):A(D)}).on("/perfil",()=>{R()?A(wt):A(D)}).on("*",()=>{R()&&A(()=>{ee()})}).notFound(()=>{te.innerHTML="<h1>404 - Página no encontrada</h1>"});function A(e){const t=document.querySelector(".page-container");if(!t){console.error("No se encontró el contenedor de la página");return}t.innerHTML="",e(),O.updatePageLinks()}const kt=(e,t)=>{const n=document.querySelector("#menu"),a=document.querySelector("#hamburger"),o=R()?e:t;R()?n.classList.add("auth"):n.classList.remove("auth"),n.innerHTML="",o.forEach(i=>{const s=document.createElement("a");s.textContent=i,s.href=`/${i.toLowerCase().replace(" ","-")}`,n.appendChild(s),s.textContent==="Acceder"&&s.classList.add("login"),s.addEventListener("click",u=>{u.preventDefault();const l=s.getAttribute("href");O.navigate(l)})}),a.classList.add("hamburger"),a.addEventListener("click",()=>{n.classList.toggle("open")});const r=()=>{window.scrollY>0?(n.classList.add("scrolled"),a.classList.add("scrolled")):(n.classList.remove("scrolled"),a.classList.remove("scrolled"))};r(),window.addEventListener("scroll",()=>{r()})},qt=["Perfil","Explora","Mis eventos","Salir"],It=["Explora","Comunidad","Acceder"],At=()=>{O.resolve(),kt(qt,It),Pe()};At();
